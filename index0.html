<body>
<style>h1 { font-size:20px;  }</style>
<h1>Before generatorified</h1>
<textarea id="prog" rows=10 cols=80>
var result=document.querySelector("#result");
function doit(x) {
    for(var i=1;i<=x;i++) {
        result.innerHTML+=i+", ";
        console.log(i);
        generatorifyRuntime.yield(1000);
    }
}
doit(3);
doit(5);
</textarea>
<!--
var C=function (x,y) {this.x=x;this.y=y;}
C.prototype.slide=function (vx,vy) {
    for(var i=0;i<5; i++) {
        this.x+=vx; this.y+=vy;
        console.log(this.x,this.y);
        generatorifyRuntime.yield(100);
    }
};
function main(x,y) {
    var c=new C(x,y);
    c.slide(1,2);
}
main(3,5);
main(30,50);

    -->
<button id="cv">generatorify!</button><br/>
<h1>After generatorified</h1>
<textarea id="converted" rows=15 cols=80></textarea>

<script src="js/generatorifyRuntime0.js"></script>
<script src="js/require.js"></script>
<script>
function sleep(ms) {
    return generatorifyRuntime.yield(ms);
}
requirejs.config({
    baseUrl:"js"
});
requirejs(["generatorify"],function (g) {
    function cv() {
        var converted=g.convert(document.querySelector("#prog").value);
        document.querySelector("#converted").value=converted;
        var gen=eval(converted);
        setTimeout(loop,0);
        function loop() {
            var v=gen.next();
            if (!v.done) {
                setTimeout(loop,v.value);
            }
        }
    }
    cv();
    document.querySelector("#cv").addEventListener("click",cv);
});
//   var syntax = esprima.parse('var answer = 42',{ range: true });
//    console.log(JSON.stringify(syntax, null, 4));
</script>
<div id="result"></div>
</body>
